" vim: set ft=vim:

" Install/update plug----------- {{{
 if empty(glob('~/.vim/autoload/plug.vim'))
   silent !curl -fLo ~/.vim/autoload/plug.vim --create-dirs
     \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
   autocmd VimEnter * PlugInstall --sync | source $MYVIMRC
 endif

call plug#begin('~/.vim/plugged')
    Plug 'junegunn/vim-plug'
    Plug 'iamcco/markdown-preview.nvim', { 'do': { -> mkdp#util#install() }, 'for': ['markdown', 'vim-plug']}
    Plug 'mhinz/vim-startify'
    Plug 'junegunn/fzf', { 'do': { -> fzf#install() } }
    Plug 'junegunn/fzf.vim'
call plug#end()
 " }}}

" Pathogen ----------- {{{
" FZF shadows the :Helptags, but it still can be done using
" :call pathogen#helptags()
call pathogen#infect()
call pathogen#helptags()
" }}}

" General Settings----------- {{{
syntax on
filetype plugin indent on

set nocompatible              " required
set hidden
" disabled in favor of ctrl-space
set showtabline=0
" uses a caseinsensitive search unless caps are
" put inside search string
set smartcase

if filereadable(expand("~/.vimrc_background"))
  source ~/.vimrc_background
endif
set encoding=utf-8
set t_Co=256                                " 256 colors
colorscheme wombat256mod
colorscheme gruvbox "wombat256mod
set guifont=mononoki\ Nerd\ Font\ 18
let g:airline_theme='minimalist'                " set airline theme
let g:airline_powerline_fonts = 1

source ~/.vim_mapping

set shell=/bin/bash
set number relativenumber

augroup numbertoggle
  autocmd!
  autocmd BufEnter,FocusGained,InsertLeave * set relativenumber
  autocmd BufLeave,FocusLost,InsertEnter   * set norelativenumber
augroup END

set ruler
set ttyfast                                 " terminal acceleration

set tabstop=4                               " 4 whitespaces for tabs visual presentation
set shiftwidth=4                            " shift lines by 4 spaces
set smarttab                                " set tabs for a shifttabs logic
set expandtab                               " expand tabs into spaces
set autoindent                              " indent when moving to the next line while writing code
" ============ open splits on the bottom or to the right =================
set splitright
set splitbelow

set cursorline                              " shows line under the cursor's line
set showmatch                               " shows matching part of bracket pairs (), [], {}

set nobackup 	                            " no backup files
set nowritebackup                           " only in case you don't want a backup file while editing
set swapfile 	                            " no swap files

set backspace=indent,eol,start              " backspace removes all (indents, EOLs, start) What is start?

set scrolloff=10                            " let 10 lines before/after cursor during scroll

set clipboard=unnamed                       " use system clipboard

set exrc                                    " enable usage of additional .vimrc files from working directory
set secure                                  " prohibit .vimrc files to execute shell, create files, etc...


" Tabs/BufferSettings" ----------- {{{
" some tab mod...
" tab sball
" some ...tab modifier. not sure what this does
" set switchbuf=useopen
" always have statusbar
set laststatus=2
" }}}

" Search Settings----------- {{{
set incsearch	                            " incremental search
set hlsearch	                            " highlight search results
" }}}

" Tagbar settings----------- {{{
let g:tagbar_autofocus=1
let g:tagbar_width=42

let g:tagbar_type_json = {
    \ 'ctagstype' : 'json',
    \ 'kinds' : [
      \ 'o:objects',
      \ 'a:arrays',
      \ 'n:numbers',
      \ 's:strings',
      \ 'b:booleans',
      \ 'z:nulls'
    \ ],
  \ 'sro' : '.',
    \ 'scope2kind': {
    \ 'object': 'o',
      \ 'ARRAY': 'a',
      \ 'number': 'n',
      \ 'string': 's',
      \ 'boolean': 'b',
      \ 'null': 'z'
    \ },
    \ 'kind2scope': {
    \ 'o': 'object',
      \ 'a': 'array',
      \ 'n': 'number',
      \ 's': 'string',
      \ 'b': 'boolean',
      \ 'z': 'null'
    \ },
    \ 'sort' : 0
    \ }
" }}}

""NERDTree settings ----------- {{{
let NERDTreeIgnore=['\.pyc$', '\.pyo$', '__pycache__$']     " Ignore files in NERDTree
let NERDTreeWinSize=40
" toggle nerdtree on cn...
nnoremap <C-n> :NERDTreeToggle<CR><C-C>
" }}}

" NERDCommenter settings" ----------- {{{
" Add spaces after comment delimiters by default
let g:NERDSpaceDelims = 1

" Use compact syntax for prettified multi-line comments
let g:NERDCompactSexyComs = 1

" Align line-wise comment delimiters flush left instead of following code indentation
let g:NERDDefaultAlign = 'left'

" Set a language to use its alternate delimiters by default
let g:NERDAltDelims_java = 1

" Add your own custom formats or override the defaults
let g:NERDCustomDelimiters = { 'c': { 'left': '/**','right': '*/' } }

" Allow commenting and inverting empty lines (useful when commenting a region)
let g:NERDCommentEmptyLines = 1

" Enable trimming of trailing whitespace when uncommenting
let g:NERDTrimTrailingWhitespace = 1
" }}}

" Indent guide settings----------- {{{
set listchars=tab:›\ ,trail:•,extends:#,nbsp:.
" }}}

" Python-mode settings" ----------- {{{
" python executables for different plugins
" pymode settings
let g:pymode = 1
let g:pymode_options = 1
let g:pymode_python='python3'
let g:pymode_warnings = 1
let g:pymode_options_max_line_length = 87
" ====  ============================
" Key   Command
" ====  ============================
" [[    Jump to previous class or function (normal, visual, operator modes)
" ]]    Jump to next class or function  (normal, visual, operator modes)
" [M    Jump to previous class or method (normal, visual, operator modes)
" ]M    Jump to next class or method (normal, visual, operator modes)
" aC    Select a class. Ex: vaC, daC, yaC, caC (normal, operator modes)
" iC    Select inner class. Ex: viC, diC, yiC, ciC (normal, operator modes)
" aM    Select a function or method. Ex: vaM, daM, yaM, caM (normal, operator modes)
" iM    Select inner function or method. Ex: viM, diM, yiM, ciM (normal, operator modes)
" ====  ============================
let g:pymode_motion = 1

let g:pymode_quickfix_minheight = 3
let g:pymode_quickfix_maxheight = 6
let g:pymode_preview_height = &previewheight
let g:pymode_preview_position = 'botright'

" code folding
let g:pymode_folding=0

" pep8 indents
let g:pymode_indent=1

" code running
let g:pymode_run=1
let g:pymode_run_bind='<leader>r'
" breakpoints
let g:pymode_breakpoint=1
let g:pymode_breakpoint_key='<leader>b'

"trim whitespace on save
let g:pymode_trim_whitespaces = 1

" rope
" |:PymodeRopeAutoImport| -- Resolve import for element under cursor
" |:PymodeRopeModuleToPackage| -- Convert current module to package
" |:PymodeRopeNewProject| -- Open new Rope project in current working directory
" |:PymodeRopeRedo| -- Redo changes from last refactoring
" |:PymodeRopeRegenerate| -- Regenerate the project cache
" |:PymodeRopeRenameModule| -- Rename current module
" |:PymodeRopeUndo| -- Undo changes from last refactoring
let g:pymode_rope_lookup_project = 0
let g:pymode_rope=0
let g:pymode_rope_completion=0
let g:pymode_rope_complete_on_dot=0
let g:pymode_rope_auto_project=0
let g:pymode_rope_enable_autoimport=0
let g:pymode_rope_autoimport_generate=0
let g:pymode_rope_guess_project=0
" Keymap for rename method/function/class/variables under cursor
let g:pymode_rope_rename_bind = '<C-c>rr'
" REname current module
let g:pymode_rope_rename_module_bind = '<C-c>r1r'
" organizes imports. unused ones are being dropped.
let g:pymode_rope_organize_imports_bind = '<C-c>ro'
let g:pymode_rope_autoimport_bind = '<C-c>ra'
" convert module to package
let g:pymode_rope_module_to_package_bind = '<C-c>r1p'
"extracting from selected lines
let g:pymode_rope_extract_method_bind = '<C-c>rm'
let g:pymode_rope_extract_variable_bind = '<C-c>rl'
" It happens when you perform move refactoring on a method of a class. In this
" refactoring, a method of a class is moved to the class of one of its
" attributes. The old method will call the new method. If you want to change all
" of the occurrences of the old method to use the new method you can inline it
" afterwards.
let g:pymode_rope_move_bind = '<C-c>rv'

" Change function signature ~
let g:pymode_rope_change_signature_bind = '<C-c>rs'

" documentationPymodeRopeRedo
let g:pymode_doc=0
let g:pymode_doc_bind='K'

" lints
" *:PymodeLint* -- Check code in current buffer
" *:PymodeLintToggle* -- Toggle code checking
" *:PymodeLintAuto* -- Fix PEP8 errors in current buffer automatically
let g:pymode_lint=1
let g:pymode_lint_checkers = ['pyflakes', 'pep8', 'mccabe']
let g:pymode_lint_ignore = ["E501", "W",]
" opens up a new window to show lints
let g:pymode_lint_cwindow = 1
let g:pymode_lint_signs = 1

" virtualenv
let g:pymode_virtualenv=1

" syntax highlight
let g:pymode_syntax=1
let g:pymode_syntax_slow_sync=0
let g:pymode_syntax_all=1
let g:pymode_syntax_print_as_function=g:pymode_syntax_all
let g:pymode_syntax_highlight_async_await=g:pymode_syntax_all
let g:pymode_syntax_highlight_equal_operator=g:pymode_syntax_all
let g:pymode_syntax_highlight_stars_operator=g:pymode_syntax_all
let g:pymode_syntax_highlight_self=g:pymode_syntax_all
let g:pymode_syntax_indent_errors=g:pymode_syntax_all
let g:pymode_syntax_string_formatting=g:pymode_syntax_all
let g:pymode_syntax_space_errors=g:pymode_syntax_all
let g:pymode_syntax_string_format=g:pymode_syntax_all
let g:pymode_syntax_string_templates=g:pymode_syntax_all
let g:pymode_syntax_doctests=g:pymode_syntax_all
let g:pymode_syntax_builtin_objs=g:pymode_syntax_all
let g:pymode_syntax_builtin_types=g:pymode_syntax_all
let g:pymode_syntax_highlight_exceptions=g:pymode_syntax_all
let g:pymode_syntax_docstrings=g:pymode_syntax_all
" }}}

" highlight 'long' lines (>= 80 symbols) in python files
augroup vimrc_autocmds
    autocmd!
    autocmd FileType python,rst,c,cpp highlight Excess ctermbg=DarkGrey guibg=Black
    " write txt files no matter they contain content
    autocmd BufNewFile *.txt :write
    " start new files in insert mode
    " interferes with tagbar...
    " autocmd BufNewFile * :startinsert
    " Disable wrapping for html
    autocmd BufNewFile,BufRead *.html setlocal nowrap
    "(re)indent html files on saving
    autocmd BufWritePre,BufRead *.html :normal gg=G
    autocmd FileType python,rst,c,cpp set nowrap
    " set comulmnmarker to 88 as recommended by black...
    autocmd FileType python,rst,c,cpp set colorcolumn=88
    " python define function or class snippets
    autocmd FileType cpp        :iabbrev <buffer> irv ito::RetVal
    autocmd FileType cpp        :iabbrev <buffer> rv retVal
    autocmd FileType cpp,python :iabbrev <buffer> rr return
    autocmd StdinReadPre * let g:isReadingFromStdin = 1

    " Start with startify as startscreen and NERDTree
    " when not directly opening some file
    autocmd VimEnter * nested if !argc() && !exists('g:isReadingFromStdin') | Startify | endif
    autocmd BufWritePre * %s/\s\+$//e
augroup END


" -Markdown plugin----------- {{{
" let g:mkdp_path_to_chrome = "firefox"
" let g:mkdp_browserfunc = 'firefox'
" Callback Vim function to open browser, the only parameter is the url to open.
" set to 1, nvim will open the preview window after entering the markdown buffer
" default: 0
let g:mkdp_auto_start = 0

" set to 1, the nvim will auto close current preview window when change
" from markdown buffer to another buffer
" default: 1
let g:mkdp_auto_close = 0

" set to 1, the vim will refresh markdown when save the buffer or
" leave from insert mode, default 0 is auto refresh markdown as you edit or
" move the cursor
" default: 0
let g:mkdp_refresh_slow = 0

" set to 1, the MarkdownPreview command can be use for all files,
" by default it can be use in markdown file
" default: 0
let g:mkdp_command_for_global = 0

" set to 1, preview server available to others in your network
" by default, the server listens on localhost (127.0.0.1)
" default: 0
let g:mkdp_open_to_the_world = 0

" use custom IP to open preview page
" useful when you work in remote vim and preview on local browser
" more detail see: https://github.com/iamcco/markdown-preview.nvim/pull/9
" default empty
let g:mkdp_open_ip = ''

" specify browser to open preview page
" default: ''
let g:mkdp_browser = ''

" set to 1, echo preview page url in command line when open preview page
" default is 0
let g:mkdp_echo_preview_url = 0

" a custom vim function name to open preview page
" this function will receive url as param
" default is empty
let g:mkdp_browserfunc = ''

" options for markdown render
" mkit: markdown-it options for render
" katex: katex options for math
" uml: markdown-it-plantuml options
" maid: mermaid options
" disable_sync_scroll: if disable sync scroll, default 0
" sync_scroll_type: 'middle', 'top' or 'relative', default value is 'middle'
"   middle: mean the cursor position alway show at the middle of the preview page
"   top: mean the vim top viewport alway show at the top of the preview page
"   relative: mean the cursor position alway show at the relative positon of the preview page
" hide_yaml_meta: if hide yaml metadata, default is 1
" sequence_diagrams: js-sequence-diagrams options
" content_editable: if enable content editable for preview page, default: v:false
let g:mkdp_preview_options = {
    \ 'mkit': {},
    \ 'katex': {},
    \ 'uml': {},
    \ 'maid': {},
    \ 'disable_sync_scroll': 0,
    \ 'sync_scroll_type': 'middle',
    \ 'hide_yaml_meta': 1,
    \ 'sequence_diagrams': {},
    \ 'flowchart_diagrams': {},
    \ 'content_editable': v:false
    \ }

" use a custom markdown style must be absolute path
" like '/Users/username/markdown.css' or expand('~/markdown.css')
let g:mkdp_markdown_css = ''

" use a custom highlight style must absolute path
" like '/Users/username/highlight.css' or expand('~/highlight.css')
let g:mkdp_highlight_css = ''

" use a custom port to start server or random for empty
let g:mkdp_port = ''

" preview page title
" ${name} will be replace with the file name
let g:mkdp_page_title = '「${name}」'

augroup vim_markdown
    autocmd!
    autocmd BufNewFile,BufRead *.markdown,*.mdown,*.mkd,*.mkdn,*.mdwn,*.md set ft=markdown
    autocmd FileType md,markdown    nnoremap <F5> :MarkdownPreview<CR>
augroup END


" }}}

" YouCompleteMe Settings----------- {{{
nnoremap <leader>g :YcmCompleter GoTo<CR>
nnoremap <leader>G :YcmCompleter GoToDefinition<CR>
nnoremap <leader>d :YcmCompleter GoToDeclaration<CR>
" nnoremap <leader>D :YcmCompleter GoToImplementation<CR>
nnoremap <leader>j :YcmCompleter GoToReferences<CR>
nnoremap <leader>f :YcmCompleter FixIt<CR>
nnoremap <leader>F :YcmDiag<CR>
" nnoremap <leader>F :YcmCompleter Format<CR>
" nnoremap <leader>E :YcmCompleter ExecuteCommand<CR>
nnoremap <leader>K :YcmCompleter GetDoc<CR>
nnoremap <leader>R :YcmCompleter RefactorRename<CR>
nnoremap <localleader>r :YcmCompleter RestartServer<CR>
"toggle hints, use nmap instead of nnoremap when using plug
nmap <leader>D <plug>(YCMHover)
"
"always use the recommended parameters for rls completer...
let g:ycm_extra_conf_globlist = [$HOME."/rust_projects/*"]
let g:ycm_enable_diagnostic_signs = 1
let g:ycm_enable_diagnostic_highlighting = 1
let g:ycm_always_populate_location_list = 1
let g:ycm_open_loclist_on_ycm_diags = 1

let g:ycm_key_invoke_completion = '<C-a>'
let g:ycm_key_list_select_completion = ['<TAB>', '<Down>']
let g:ycm_key_list_previous_completion = ['<C-a>', '<Up>']
let g:ycm_complete_in_comments = 1
let g:ycm_seed_identifiers_with_syntax = 1
let g:ycm_collect_identifiers_from_comments_and_strings = 1
let g:ycm_language_server =
\ [
\   {
\     'name': 'rust',
\     'cmdline': ['rust-analyzer'],
\     'filetypes': ['rust'],
\     'project_root_files': ['Cargo.toml']
\   }
\ ]
let g:ycm_filetype_blacklist = {}
" }}}

" Ultisnips settings----------- {{{
" Trigger configuration. Do not use <tab> if you use https://github.com/Valloric/YouCompleteMe.
let g:UltiSnipsExpandTrigger="<c-e>"
let g:UltiSnipsJumpForwardTrigger="<c-b>"
let g:UltiSnipsJumpBackwardTrigger="<c-z>"

" If you want :UltiSnipsEdit to split your window.
"let g:UltiSnipsEditSplit="vertical"
"" }}}
"
" -vimtex settings----------- {{{

let g:vimtex_view_general_viewer = 'okular'
let g:vimtex_view_general_options = '--unique file:@pdf\#src:@line@tex'
let g:vimtex_view_general_options_latexmk = '--unique'
let g:tex_flavor = 'xelatex'
"  " }}}


" Slime Settings ----------- {{{
" this one is helpful for ssh sessions and such, keybindings for
" tmus start with <C-b>; a vert split is '%' a hor split is '"' for example
let g:slime_target = 'tmux'
let g:slime_default_config = {'socket_name': 'default', 'target_pane': '{last}'}
" let g:slime_target = 'vimterminal'
" let g:slime_vimterminal_config = {options}
" let g:slime_vimterminal_cmd = 'command'
" put the delimiter  parts in the corresponding ftplugin
"let g:slime_cell_delimiter = '#%%'
" nmap <leader>s <Plug>SlimeSendCell
"
" }}}


" Tabular mapping, common to all files----------- {{{
if exists(":Tabularize")
    " aligns along '='
    nmap <Leader>a= :Tabularize /=<CR>
    vmap <Leader>a= :Tabularize /=<CR>
    " align along ':'
    nmap <Leader>a: :Tabularize /:\zs<CR>
    vmap <Leader>a: :Tabularize /:\zs<CR>
    " aligns along '|'
    nmap <Leader>a<Bar> :Tabularize /<Bar>\zs<CR>
    vmap <Leader>a<Bar> :Tabularize /<Bar>\zs<CR>
endif
" }}}







" vim: set ft=vim:
let mapleader=","
let maplocalleader=",,"

nnoremap <leader>; :execute "normal! mqA;\e`q"<CR>

" vimrc management----------- {{{
nnoremap <leader>ev     :vs $MYVIMRC<CR>
nnoremap <leader>sv     :source $MYVIMRC<CR>ZZ
" }}}

" F5/run mapping----------- {{{
augroup F5_run_mapping
    autocmd!
    autocmd FileType rust nnoremap <F5> :!clear;cargo run;
    autocmd FileType python nnoremap <F5>   python3;clear;python3 %s;
nnoremap <F5>   python3;clear;python3 %s;
" }}}


" spacebar folding----------- {{{
nnoremap <space>        za
" }}}

" put esc on jk----------- {{{
vnoremap jk  <ESC>
vnoremap <ESC> <nop>
inoremap jk  <ESC>
inoremap <ESC> <nop>
" }}}

" remap motion----------- {{{
no <down> <Nop>
no <left> <Nop>
no <right> <Nop>
no <up> <Nop>

ino <down> <Nop>
ino <left> <Nop>
ino <right> <Nop>
ino <up> <Nop>

vno <down> <Nop>
vno <left> <Nop>
vno <right> <Nop>
vno <up> <Nop>
" }}}

" Nerdtree----------- {{{
nnoremap <C-n> :NERDTreeToggle<CR><C-C>
" }}}

" Tagbar----------- {{{
nnoremap <F8> :TagbarToggle<CR>
" }}}

" abbreviations, common----------- {{{
iabbrev oweb oliver.schwanke@web.de
iabbrev twipweb    schwanke@twip-os.com
iabbrev tehn then
iabbrev tahn than
iabbrev adn and
iabbrev waht what
iabbrev isntall install
" }}}

" relative Numbering----------- {{{
nnoremap <F4> :set relativenumber!<CR>
" }}}

" operator remapping" ----------- {{{
" parenthesis
onoremap p i(
" delete function body
onoremap b /return<CR>
" change contents of next parenthesis(
onoremap in( :<c-u>normal! f(vi(<CR>
" change contents of last parenthesis
onoremap il( :<c-u>normal! F)vi(<CR>
" change including parenthesis
onoremap an( :<c-u>normal! f(va(<CR>
onoremap an( :<c-u>normal! F(va(<CR>
" change inside curly braces
onoremap in{ :<c-u>normal! f{vi{<CR>
onoremap il{ :<c-u>normal! F{vi{<CR>
" change including curly braces
onoremap an{ :<c-u>normal! f{va{<CR>
onoremap al{ :<c-u>normal! F{va{<CR>
" check omap-info for details
" " }}}

" Vimscript filetype settings -------------------- {{{
augroup filteype_vim
    autocmd!
    autocmd FileType vim nnoremap --- O" ----------- {{{<ESC>0la
    autocmd FileType vim nnoremap ___ o" }}}<ESC>
    autocmd FileType vim setlocal foldmethod=marker
augroup END
" }}}


" Buffer Management----------- {{{
set wildmode=list:full
set wildignorecase
set wildignore=*.swp,*.bak
set wildignore+=*.pyc,*.class,*.sln,*.Master,*.csproj,*.csproj.user,*.cache,*.dll,*.pdb,*.min.*
set wildignore+=*/.git/**/*,*/.hg/**/*,*/.svn/**/*
set wildignore+=tags
set wildignore+=*.tar.*
set wildcharm=<C-z>
" This one opens a tabbable list to scroll through open buffers

nnoremap <leader>b :buffer <C-z><S-Tab>
nnoremap <leader>B :vs <C-z><S-Tab>
" nnoremap <leader>b :ls<CR>:b<Space>
" nnoremap <leader>l :bn<CR>
" nnoremap <leader>h :bn<CR>

set path=.,**
nnoremap <localleader>f :find *
nnoremap <localleader>s :sfind *
nnoremap <localleader>v :vert sfind *
nnoremap <localleader>t :tabfind *

nnoremap <leader>F: find <C-R>=expand('%:h').'/*'<CR>
nnoremap <leader>S: sfind <C-R>=expand('%:h').'/*'<CR>
nnoremap <leader>V: vert sfind <C-R>=expand('%:h').'/*'<CR>
nnoremap <leader>T: tabfind <C-R>=expand('%:h').'/*'<CR>

" This sets marks to jump back to the last modified file
" with given filename/Ending

augroup automarks
  autocmd!
  autocmd BufLeave *.cpp  normal! mC
  autocmd BufLeave *.h normal! mH
  autocmd BufLeave *.rs   normal! mR
  autocmd BufLeave *.py  normal! mP
augroup END

" new vertical split can be opened using ctrl-w t
" }}}

" Vimscript filetype settings -------------------- {{{
augroup filteype_vim
    autocmd FileType lua setlocal foldmethod=marker
augroup END
" }}}

" vimspector----------- {{{
" let g:vimspector_enable_mappings = 'HUMAN'
" }}}

" vimwiki----------- {{{
function! VimwikiFindIncompleteTasks()
    lvimgrep /- \[ \]/ %:p
    lopen
endfunction

function! VimwikiFindAllIncompleteTasks()
    VimwikiSearch /- \[ \]/
    lopen
endfunction

nmap <Leader>wa :call VimwikiFindAllIncompleteTasks()<CR>
nmap <Leader>wx :call VimwikiFindIncompleteTasks()<CR>

let g:vimwiki_list = [{'path' : '~/ownCloud/Notes/', 'syntax' : 'markdown', 'ext': '.md'}]
" Only treat md within the NOtes folder as vimwikifiles
let g:vimwiki_global_ext = 0
"
" disable tab mappigns for vimwiki
let g:vimwiki_table_mappings=0
function! VimwikiLinkHandler(link)
    " Use Vim to open external files with the 'vfile:' scheme.  E.g.:
    "   1) [[vfile:~/Code/PythonProject/abc123.py]]
    "   2) [[vfile:./|Wiki Home]]
    let link = a:link
    if link =~# '^vfile:'
        let link = link[1:]
    else
        return 0
    endif
    let link_infos = vimwiki#base#resolve_link(link)
    if link_infos.filename == ''
        echomsg 'Vimwiki Error: Unable to resolve link!'
        return 0
    else
        exe 'edit ' . fnameescape(link_infos.filename)
        return 1
    endif
endfunction
" " }}}


